#:import os os

<MapMarker>:
    size_hint_y: 0
    height: 15

<Background>:

<ManeuverIcon>:

<GestureBox>:
    id: gesture_box
    disabled: False

<HeaderIcon>:
    size_hint_x: None
    width: 55
    size_hint_y: None
    height: 35
    top: root.top

<Header>:
    id: gen_header
    cols: 2
    size_hint_y: None
    opacity: 1
    height: 50
    GridLayout:
        id: left
        cols: 1
        canvas.before:
            Rectangle:
                size: self.size
                pos: self.pos
                source: root.left_image
        HeaderIcon:
            id: con_gps
            canvas:
                Rectangle:
                    size: self.size
                    pos: self.pos
                    id: gps_icon
                    source: root.get_drone_gps_connection()
    BoxLayout:
        id: right
        padding: [45, 5, 5, 10]
        spacing: 10
        canvas:
            Rectangle:
                size: self.size
                pos: self.pos
                source: root.right_image
        HeaderIcon:
            id: con_gps
            canvas:
                Rectangle:
                    size: self.size
                    pos: self.pos
                    id: gps_icon
                    source: root.get_con_gps_connection()
        HeaderIcon:
            id: connection
            canvas:
                Rectangle:
                    size: self.size
                    pos: self.pos
                    id: drone_connection
                    source: root.get_drone_connection()
        HeaderIcon:
            id: battery
            height: 29
            canvas:
                Color:
                    rgba: root.battery_level_color
                Rectangle:
                    size: self.width - (16 + root.battery_conversion_factor), self.height - 9  # Default is -16, -9
                    pos: self.x + (12 + root.battery_conversion_factor), self.y + 5  # Default is +12, +5
                Rectangle:
                    size: self.size
                    pos: self.pos
                    id: battery_level
                    source: root.battery_image

<Footer>:
    id: gen_footer
    size_hint_y: None
    height: 50
    opacity: 1
    orientation: "horizontal"
    canvas:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<FlightStats>:
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
    name: 'Flight_Stats'
    Background:
    Header:
        id: fs_header
        top: root.height
        opacity: 1
    Footer:
        id: fs_footer
        opacity: 1
    GestureBox:
        disabled: False

<ToolBar>:

<MapScr>:
    name: 'Map'
    id: map_scr
    Background:
    Map:
        id: map
        lat: self.con_lat
        lon: self.con_lon
        zoom: 16
        disabled: False
        MapMarker:
            id: drone_marker
            source: map.drone_icon
            lat: map.drone_lat
            lon: map.drone_lon
            size_hint_y: 0
            height: map.marker_height
        MapMarker:
            id: con_marker
            source: map.con_icon
            lat: map.con_lat
            lon: map.con_lon
            size_hint_y: 0
            height: map.marker_height
            disabled: map.get_con_gps()
    Header:
        id: fs_header
        top: root.height
        opacity: 1
    Footer:
        id: fs_footer
        opacity: 1
        ManeuverIcon:
            id: move_to
            source: os.path.abspath("icons/DroneIcon.png")
            on_release: self.update_map_mode()
    GestureBox:
        disabled: True

<Video>:
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
    name: 'Video'
    Background:
    Header:
        id: fs_header
        top: root.height
        opacity: 1
    Footer:
        id: fs_footer
        opacity: 1
    GestureBox:
        disabled: False


<Diagnostics>:
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
    name: 'Diagnostics'
    Background:
    Footer:
    GestureBox:
        disabled: False

<SettingsButton>
    size_hint_y: None
    height: 40

<SettingsLabel>
    size_hint_y: None
    height: 40
    color: root.text_color
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos

<SettingsSwitch>
    size_hint_y: None
    height: 40

<Settings>:
    canvas.before:
        Color:
            rgba: root.background_color
        Rectangle:
            size: self.size
            pos: self.pos
    name: 'Settings'
    Background:
    ScrollView:
        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            cols: 2
    Footer:
    GestureBox:
        disabled: False